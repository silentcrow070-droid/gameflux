<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GAMEFLUX | 清新遊戲情報</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #ffffff;
    --surface: #f8f9fa;
    --card: #ffffff;
    --text-main: #1a1a1a;
    --text-sub: #666666;
    --accent: #00b4d8; /* 清新青藍色 */
    --border: #ececec;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { 
    background-color: var(--bg); 
    color: var(--text-main); 
    font-family: 'Inter', 'Noto Sans TC', sans-serif;
    line-height: 1.6;
  }

  /* 導航列 */
  header {
    position: sticky; top: 0; z-index: 100;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    padding: 0 10%;
    display: flex; align-items: center; justify-content: space-between;
    height: 70px;
  }
  .logo { font-size: 1.4rem; font-weight: 800; letter-spacing: -0.5px; color: var(--text-main); }
  .logo span { color: var(--accent); }

  .refresh-btn {
    background: var(--surface); border: 1px solid var(--border);
    padding: 8px 16px; font-size: 0.8rem; border-radius: 20px;
    cursor: pointer; transition: 0.3s;
  }
  .refresh-btn:hover { background: #eee; }

  /* 頂部跑馬燈 - 改為淺色背景 */
  .ticker-wrap { background: var(--surface); border-bottom: 1px solid var(--border); height: 40px; display: flex; align-items: center; overflow: hidden; }
  .ticker-track { display: flex; animation: ticker 60s linear infinite; white-space: nowrap; }
  .ticker-track span { padding: 0 40px; font-size: 0.85rem; color: var(--text-sub); }
  @keyframes ticker { from { transform: translateX(0); } to { transform: translateX(-50%); } }

  /* 主要內容 */
  main { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
  .section-title { font-size: 1.8rem; margin-bottom: 30px; font-weight: 700; text-align: center; }

  .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; }
  
  .card { 
    background: var(--card); border-radius: 16px; overflow: hidden; 
    border: 1px solid var(--border); transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
  }
  .card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.05); border-color: var(--accent); }
  
  .thumb { width: 100%; aspect-ratio: 16/10; background: #f0f0f0; overflow: hidden; }
  .thumb img { width: 100%; height: 100%; object-fit: cover; }
  
  .content { padding: 20px; }
  .meta { font-size: 0.75rem; color: var(--accent); font-weight: 700; margin-bottom: 8px; text-transform: uppercase; }
  .title { font-size: 1.05rem; font-weight: 700; color: var(--text-main); margin-bottom: 12px; height: 3rem; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
  .date { font-size: 0.75rem; color: var(--text-sub); margin-bottom: 15px; display: block; }
  
  .read-more { 
    display: inline-block; padding: 8px 0; color: var(--accent); 
    text-decoration: none; font-size: 0.9rem; font-weight: 700;
  }

  /* 骨架載入動畫 */
  .skeleton { height: 350px; background: #f5f5f5; border-radius: 16px; }

  footer { padding: 60px 0; text-align: center; color: var(--text-sub); font-size: 0.8rem; border-top: 1px solid var(--border); }

  @media (max-width: 768px) { header { padding: 0 5%; } }
</style>
</head>
<body>

<header>
  <div class="logo">GAME<span>FLUX</span></div>
  <button class="refresh-btn" id="refBtn" onclick="fetchData()">刷新內容</button>
</header>

<div class="ticker-wrap">
  <div class="ticker-track" id="ticker"><span>正在從全球 10 大媒體同步近一週精選情報...</span></div>
</div>

<main>
  <h2 class="section-title">精選遊戲週報</h2>
  <div id="newsGrid" class="grid">
    <div class="skeleton"></div><div class="skeleton"></div><div class="skeleton"></div>
  </div>
</main>

<footer>
  &copy; 2024 GAMEFLUX GLOBAL // 數據來源：IGN, GameSpot, 巴哈姆特等主流媒體
</footer>

<script>
async function fetchData() {
  const btn = document.getElementById('refBtn');
  const grid = document.getElementById('newsGrid');
  btn.innerText = '同步中...';

  try {
    const res = await fetch('/api/news');
    const data = await res.json();
    
    if (data.articles) {
      // 跑馬燈
      const tContent = data.articles.slice(0,10).map(a => a.title).join(' • ');
      document.getElementById('ticker').innerHTML = `<span>${tContent}</span><span>${tContent}</span>`;
      
      // 渲染列表
      grid.innerHTML = data.articles.map(a => `
        <article class="card">
          <div class="thumb">${a.image ? `<img src="${a.image}" loading="lazy">` : ''}</div>
          <div class="content">
            <div class="meta">${a.source}</div>
            <h3 class="title">${a.title}</h3>
            <span class="date">${a.date}</span>
            <a href="${a.url}" target="_blank" class="read-more">閱讀全文 →</a>
          </div>
        </article>
      `).join('');
    }
  } catch (err) {
    grid.innerHTML = `<p style="grid-column:1/-1;text-align:center;color:red;padding:50px;">無法取得內容，請確認 API 額度或環境變數。<br><small>${err.message}</small></p>`;
  } finally {
    btn.innerText = '刷新內容';
  }
}

fetchData();
// 每 30 分鐘自動同步一次
setInterval(fetchData, 1800000);
</script>
</body>
</html>
